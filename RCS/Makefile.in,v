head	1.5;
access;
symbols;
locks
	matt:1.5; strict;
comment	@# @;


1.5
date	2002.02.10.19.30.52;	author matt;	state Exp;
branches;
next	1.4;

1.4
date	2001.10.15.18.41.17;	author matt;	state Exp;
branches;
next	1.3;

1.3
date	2001.07.30.11.42.45;	author matt;	state Exp;
branches;
next	1.2;

1.2
date	2001.07.18.17.31.44;	author matt;	state Exp;
branches;
next	1.1;

1.1
date	2001.05.24.12.09.05;	author matt;	state Exp;
branches;
next	;


desc
@Autoconf template file.
@


1.5
log
@Updated list of source files
@
text
@

srcdir= @@srcdir@@
prefix=@@prefix@@
exec_prefix=@@exec_prefix@@
libexecdir=@@libexecdir@@
bindir=$(prefix)/sbin
mandir=$(prefix)/man/man8

LN_S=@@LN_S@@

etcdir=/etc
SSMTPCONFDIR=$(etcdir)/ssmtp
# (End of relocation section)

# Configuration files
CONFIGURATION_FILE=$(SSMTPCONFDIR)/ssmtp.conf
REVALIASES_FILE=$(SSMTPCONFDIR)/revaliases

INSTALLED_CONFIGURATION_FILE=$(CONFIGURATION_FILE)
INSTALLED_REVALIASES_FILE=$(REVALIASES_FILE)

# Programs
GEN_CONFIG=$(srcdir)/generate_config

SRCS=main.c header.c rcpt.c from.c net.c log.c options.c util.c \
	arpadate.c base64.c

OBJS=$(SRCS:.c=.o)

INSTALL=@@INSTALL@@

EXTRADEFS=\
-DSSMTPCONFDIR=\"$(SSMTPCONFDIR)\" \
-DCONFIGURATION_FILE=\"$(CONFIGURATION_FILE)\" \
-DREVALIASES_FILE=\"$(REVALIASES_FILE)\" \


CFLAGS=-Wall @@DEFS@@ $(EXTRADEFS) @@CFLAGS@@

.PHONY: all
all: ssmtp

%.dvi: %.tex
	latex $<

.PHONY: install
install: ssmtp $(GEN_CONFIG)
	$(INSTALL) -d -m 755 $(bindir)
	$(INSTALL) -s -m 755 ssmtp $(bindir)/ssmtp
	$(INSTALL) -d -m 755 $(mandir)
	$(INSTALL) -m 644 $(srcdir)/ssmtp.8 $(mandir)/ssmtp.8
	$(INSTALL) -d -m 755 $(SSMTPCONFDIR)
	$(INSTALL) -m 644 $(srcdir)/revaliases $(INSTALLED_REVALIASES_FILE)
	$(GEN_CONFIG) $(INSTALLED_CONFIGURATION_FILE)


.PHONY: install-sendmail
install-sendmail: install
	$(RM) $(bindir)/sendmail
	$(LN_S) ssmtp $(bindir)/sendmail
	$(INSTALL) -d -m 755 $(libexecdir)
	$(RM) $(libexecdir)/sendmail
	$(LN_S) sendmail /lib/sendmail
	$(RM) $(mandir)/sendmail.8
	$(LN_S) ssmtp.8 $(mandir)/sendmail.8

.PHONY: uninstall
uninstall:
	$(RM) $(bindir)/ssmtp
	$(RM) $(mandir)/ssmtp.8
	$(RM) $(CONFIGURATION_FILE) $(REVALIASES_FILE)
	$(RM) -r $(SSMTPCONFDIR)

.PHONY: uninstall-sendmail
uninstall-sendmail: uninstall
	$(RM)  $(bindir)/sendmail /lib/sendmail
	$(RM)  $(mandir)/sendmail.8

# Binaries:
ssmtp: $(OBJS)
	$(CC) -o ssmtp $(OBJS) @@LIBS@@ 

vpath %.c $(srcdir)

.PHONY: clean
clean:
	$(RM) ssmtp *.o core

.PHONY: distclean
distclean: clean docclean
	$(RM) config.* Makefile

.PHONY: docclean
docclean:
	$(RM) *.dvi *.log *.aux
@


1.4
log
@Remove parseaddr.c from build list.
@
text
@d26 2
a27 1
SRCS=ssmtp.c net.c logging.c arpadate.c base64.c
@


1.3
log
@Added -Wall flag.
@
text
@d26 1
a26 1
SRCS=ssmtp.c net.c logging.c arpadate.c parseaddr.c base64.c
@


1.2
log
@Removed string_ext.c
@
text
@d26 1
a26 1
SRCS=ssmtp.c logging.c arpadate.c parseaddr.c base64.c
d38 1
a38 1
CFLAGS=@@DEFS@@ $(EXTRADEFS) @@CFLAGS@@ 
@


1.1
log
@Initial revision
@
text
@d26 1
a26 1
SRCS= ssmtp.c arpadate.c parseaddr.c string_ext.c logging.c base64.c
@
